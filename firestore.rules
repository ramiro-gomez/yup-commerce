rules_version = '2';
service cloud.firestore {
	match /databases/{database}/documents {
		match /users/{userId} {
			function userDataIsValid() {
				return request.auth.uid == userId &&
				request.resource.data.firstName is string &&
				request.resource.data.lastName is string &&
				request.resource.data.size() == 2;
			}
			allow get: if request.auth.uid == userId;
			allow create: if userDataIsValid();
		}
		match /products/{productId} {
			allow read;
		}
	}
}